<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zoom & Pan Fullscreen Image</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: black;
  }
  canvas {
    display: block;
    width: 100%;
    height: 100%;
    touch-action: none; /* prevent touch scrolling */
    cursor: grab;
  }
  canvas:active {
    cursor: grabbing;
  }
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let img = new Image();
img.src = "background.png"; // <-- use your uploaded filename
let scale = 1, minScale = 1;
let offsetX = 0, offsetY = 0;
let isDragging = false;
let dragStartX, dragStartY;

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  fitImage();
  draw();
}

function fitImage() {
  if (!img.complete) return;
  const scaleX = canvas.width / img.width;
  const scaleY = canvas.height / img.height;
  minScale = Math.max(scaleX, scaleY); // cover screen fully
  if (scale < minScale) scale = minScale;
  constrain();
}

function constrain() {
  const imgW = img.width * scale;
  const imgH = img.height * scale;

  const minX = canvas.width - imgW;
  const minY = canvas.height - imgH;

  if (offsetX > 0) offsetX = 0;
  if (offsetY > 0) offsetY = 0;
  if (offsetX < minX) offsetX = minX;
  if (offsetY < minY) offsetY = minY;
}

function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(img, offsetX, offsetY, img.width * scale, img.height * scale);
}

img.onload = () => {
  resizeCanvas();
};

window.addEventListener('resize', resizeCanvas);

canvas.addEventListener('mousedown', e => {
  isDragging = true;
  dragStartX = e.clientX - offsetX;
  dragStartY = e.clientY - offsetY;
});
canvas.addEventListener('mouseup', () => isDragging = false);
canvas.addEventListener('mouseleave', () => isDragging = false);
canvas.addEventListener('mousemove', e => {
  if (isDragging) {
    offsetX = e.clientX - dragStartX;
    offsetY = e.clientY - dragStartY;
    constrain();
    draw();
  }
});

// Zoom with wheel
canvas.addEventListener('wheel', e => {
  e.preventDefault();
  const zoomFactor = 1.1;
  const mouseX = e.clientX;
  const mouseY = e.clientY;

  const wx = (mouseX - offsetX) / scale;
  const wy = (mouseY - offsetY) / scale;

  if (e.deltaY < 0) {
    scale *= zoomFactor;
  } else {
    scale /= zoomFactor;
  }

  if (scale < minScale) scale = minScale;

  offsetX = mouseX - wx * scale;
  offsetY = mouseY - wy * scale;

  constrain();
  draw();
}, { passive: false });

// Touch support
let lastTouchDist = null;
let lastTouchX = null, lastTouchY = null;

canvas.addEventListener('touchstart', e => {
  if (e.touches.length === 1) {
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;
  } else if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    lastTouchDist = Math.hypot(dx, dy);
  }
}, { passive: false });

canvas.addEventListener('touchmove', e => {
  e.preventDefault();
  if (e.touches.length === 1 && lastTouchX !== null) {
    const dx = e.touches[0].clientX - lastTouchX;
    const dy = e.touches[0].clientY - lastTouchY;
    offsetX += dx;
    offsetY += dy;
    lastTouchX = e.touches[0].clientX;
    lastTouchY = e.touches[0].clientY;
  } else if (e.touches.length === 2) {
    const dx = e.touches[0].clientX - e.touches[1].clientX;
    const dy = e.touches[0].clientY - e.touches[1].clientY;
    const dist = Math.hypot(dx, dy);
    if (lastTouchDist) {
      const zoom = dist / lastTouchDist;
      scale *= zoom;
      if (scale < minScale) scale = minScale;
    }
    lastTouchDist = dist;
  }
  constrain();
  draw();
}, { passive: false });

canvas.addEventListener('touchend', e => {
  if (e.touches.length === 0) {
    lastTouchX = null;
    lastTouchY = null;
    lastTouchDist = null;
  }
}, { passive: false });
</script>
</body>
</html>
